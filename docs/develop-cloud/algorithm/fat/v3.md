```bash
POST /api/weight/algorithm/v3.0/getWeightIndexCalculateResult
```
**入参：**

| 字段 | 类型 | 描述 | 是否必传 | 备注 |
| --- | --- | --- | --- | --- |
| userId | String | 用户ID | 是 | 用户唯一标识 |
| deviceId | String | 设备ID | 是 | 设备唯一标识 |
| sex | Integer | 性别 | 是 | 1-男；2-女 |
| age | Integer | 年龄 | 是 |  |
| height | Double | 身高 | 是 | 单位：m； |
| weight | Double | 体重 | 是 | 单位：kg； |
| resistance | Double | 阻抗值 | 是 | 阻抗值通过体脂称测量得到，是计算体脂率相关指标的核心参数，当未测量到阻抗或者阻抗值为0时，无法进行计算。 |
| hisRecordList | List(Object) | 历史数据 | 是 | 需满足条件：<br />1.当前这笔数据的测量时间之前最近的30笔历史数据；<br />2.历史数据用户信息中身高、性别，需与当前记录一致，年龄一致或者小1岁；<br />3.有阻抗的历史数据。 |

历史数据：

| 字段 | 类型 | 描述 | 是否必传 | 备注 |
| --- | --- | --- | --- | --- |
| deviceId | String | 设备ID | 是 | 设备唯一标识 |
| weight | Double | 体重 | 是 | <br /> |
| resistance | Double | 阻抗 | 是 | 取值范围(300, 1000) |
| measurementDate | Date | 测量时间 | 是 | <br /> |
| pbf | Double | 体脂率 | 是 | 算法返回的pbf，使用方应进行存储，本次调用时进行填充。 |
| pbfFactor | Double | 体成分影响因子 | 是 | 算法返回的pbfFactor，使用方应进行存储，本次调用时进行填充。 |


**入参示例：**
```json
{
    "userId":218977235,
    "sex":2,
    "age":24,
    "height":1.64,
    "weight":52.5,
    "resistance":755.6,
    "hisRecordList":[
        {
            "weight":51.2,
            "pbf":23.8,
            "measurementDate":1647474423000,
            "resistance":601.32,
            "pbfFactor":1570.879
        },
        {
            "weight":50.9,
            "pbf":23.3,
            "measurementDate":1647386754000,
            "resistance":595.87,
            "pbfFactor":1753.612
        },
        {
            "weight":51,
            "pbf":23.6,
            "measurementDate":1647386704000,
            "resistance":600.56,
            "pbfFactor":1809.483
        },
        {
            "weight":50.8,
            "pbf":33.2,
            "measurementDate":1647386604000,
            "resistance":788.13,
            "pbfFactor":1936.625
        }
    ]
}
```
**出参：**

| 字段 | 类型 | 描述 | 备注 |
| --- | --- | --- | --- |
| resCode | Integer | 结果码 | 0 or 1 |
| resultStatus | Integer | 数据结果状态 |  |
| resultMsg | String | 数据结果描述 |  |
| visceralFat | Double | 内脏脂肪指数，保留0位小数 | 阻抗异常时，无法计算。 |
| basalMetabolism | Double | 基础代谢量，保留0位小数 | 阻抗异常时，无法计算。 |
| protein | Double | 蛋白质，单位:%，保留1位小数 | 阻抗异常时，无法计算。 |
| ageOffset | Integer | 身体年龄偏移，实际年龄+年龄偏移=身体年龄 | 阻抗异常时，无法计算。 |
| bodyScore | Double | 身体得分，0-100分，保留1位小数 | 阻抗异常时，无法计算。 |
| bodyStyle | String | 体型 | 阻抗异常时，无法计算。<br />隐性肥胖型<br />偏胖型<br />结实偏胖型<br />缺乏运动型<br />标准型<br />健壮型<br />精瘦型<br />模特型<br />健美型 |
| age | Integer | 年龄 | <br /> |
| sex | Integer | 性别 | 男-1，女-2 |
| height | Double | 身高，单位:米 | <br /> |
| weight | Double | 体重，单位:kg | <br /> |
| resistance50k | Double | 电阻值，同入参的resistance | <br /> |
| bmi | Double | 体质指数，bmi，保留2位小数 | <br /> |
| pbf | Double | 脂肪率， 单位：%，保留2位小数 | 阻抗异常时，无法计算。 |
| muscle | Double | 肌肉量，单位:kg，保留2位小数 | 阻抗异常时，无法计算。 |
| beatPercent | Double | 击败百分比，保留1位小数 | 阻抗异常时，无法计算。 |
| water | Double | 水分率，保留2位小数 | 阻抗异常时，无法计算。 |
| bone | Double | 骨骼量, 单位:kg，保留2位小数 | 阻抗异常时，无法计算。 |
| ffm | Double | 去脂体重，kg， | 阻抗异常时，无法计算。 |
| bfm | Double | 脂肪量，kg，保留1位小数 | 阻抗异常时，无法计算。 |
| rateOfMuscle | Double | 肌肉率 ，单位：%，保留1位小数 | 阻抗异常时，无法计算。 |
| skeletonMuscle | Double | 骨骼肌，kg，保留1位小数 | 阻抗异常时，无法计算。 |
| bodyAge | Integer | 身体年龄 | 阻抗异常时，无法计算。 |
| visceralFatLevel | Integer | 内脏脂肪等级 | 阻抗异常时，无法计算。<br />0-理想，1-偏高，2-较高，3-超高 |
| fatControl | Double | 脂肪控制，小于 0 表示建议增加脂肪量， 大于 0 表示应减少脂肪量；保留1位小数 | 阻抗异常时，无法计算。 |
| muscleControl | Double | 肌肉控制，0 表示理想，大于 0 表示建议 增加的肌肉量，不存在小于 0 情况 | 阻抗异常时，无法计算。 |
| pbfFactor | Double | 体成分影响因子 |  |


**出参示例：**
```json
{
    "code":200,
    "msg":"成功",
    "data":{
        "visceralFat":5,
        "basalMetabolism":1393,
        "protein":15.6,
        "ageOffset":-1,
        "bodyScore":80,
        "bodyStyle":"健壮型",
        "beatPercent":83.1,
        "age":24,
        "sex":2,
        "height":1.67,
        "weight":68.8,
        "bmi":24.67,
        "pbf":31.18,
        "muscle":44.41,
        "bone":2.97,
        "water":48.93,
        "resistance50k":455,
        "bfm":21.5,
        "ffm":47.3,
        "rateOfMuscle":64.5,
        "skeletonMuscle":25.4,
        "bodyAge":23,
        "muscleControl":0,
        "fatControl":0,
        "visceralFatLevel":0,
        "pbfFactor":1809.947,
        "resCode":1,
        "resultStatus":200
    }
}
```
**返回码说明：建议resCode=1的数据展示给用户使用。**

| **结果码(resCode)** | **说明** | **状态码(resultStatus)** | **描述** |
| --- | --- | --- | --- |
| **1** | **推荐使用** | 200 | 成功 |
|  |  | 101 | 冷启中积累数据 |
|  |  | 103 | 冷启结束 |
| **0** | **不推荐使用** | 990 | 参数为空或缺失 |
|  |  | 991 | 年龄超出取值范围：(18, 65) |
|  |  | 992 | 身高超出取值范围：男(155,190)女(145,180) |
|  |  | 993 | 体重超出取值范围：男(45,120)女(35,110) |
|  |  | 994 | 阻抗超出取值范围：(300, 1000) |
|  |  | 999 | 算法分析异常 |

**注意事项：**使用此算法，使用方至少需要存储算法返回的如下结果：pbf、pbfFactor，用于下次调用的输入。














